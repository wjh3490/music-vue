(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["search"],{"0f70":function(t,e,s){"use strict";var a=s("6c8f"),r=s.n(a);r.a},"4bbc":function(t,e,s){},"6c8f":function(t,e,s){},a0a1:function(t,e,s){"use strict";var a=s("4bbc"),r=s.n(a);r.a},b16c:function(t,e,s){"use strict";var a=s("df6e"),r=s.n(a);r.a},c975:function(t,e,s){"use strict";var a=s("23e7"),r=s("4d64").indexOf,n=s("a640"),i=s("ae40"),c=[].indexOf,o=!!c&&1/[1].indexOf(1,-0)<0,l=n("indexOf"),u=i("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:o||!l||!u},{indexOf:function(t){return o?c.apply(this,arguments)||0:r(this,t,arguments.length>1?arguments[1]:void 0)}})},df6e:function(t,e,s){},efe3:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search"},[s("BaseBack",{attrs:{isFixed:!0,background:"rgb(22, 154, 243"},scopedSlots:t._u([{key:"right",fn:function(){return[s("span",{staticStyle:{"font-size":"15px"},on:{click:t.cancle}},[t._v("取消")])]},proxy:!0}])},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchData,expression:"searchData"}],staticClass:"search-input",attrs:{type:"text",placeholder:"热门"},domProps:{value:t.searchData},on:{input:function(e){e.target.composing||(t.searchData=e.target.value)}}})]),s("div",{staticClass:"item"},[s("SearchList",{key:"hot",attrs:{list:t.hotLsit,hotTitle:"热门搜索",visible:!t.searchData,vertical:!0},on:{handleSearch:function(e){return t.searchData=e}}}),s("SearchList",{key:"history",attrs:{visible:!t.searchData,hotTitle:"历史记录",list:t.historyList,vertical:!1},on:{handleSearch:function(e){return t.searchData=e},del:t.del}}),s("SearchResult",{attrs:{list:t.searchList,noResult:t.noResult},on:{play:t.play},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[s("div",{staticClass:"name ellipsis",domProps:{innerHTML:t._s(t.highlight(a.name))}}),s("div",{staticClass:"singer ellipsis",domProps:{innerHTML:t._s(t.highlight(a.singer))}})]}}])})],1)],1)},r=[],n=(s("c740"),s("c975"),s("13d5"),s("a434"),s("b0c0"),s("dca8"),s("4d63"),s("ac1f"),s("25f0"),s("5319"),s("96cf"),s("1da1")),i=s("5530"),c=s("2f62"),o=s("2b4c");function l(t){return Object(o["a"])({url:"/search?keywords=".concat(t," "),method:"get"})}function u(){return Object(o["a"])({url:"/search/hot ",method:"get"})}var h=s("ed08"),f=function(t,e){var s=e._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.props.visible,expression:"props.visible"}],class:e.props.vertical?"hot":"history"},[s("p",{staticClass:"search-name"},[e._v(e._s(e.props.hotTitle))]),e.props.vertical?e._e():s("div",{staticClass:"del"},[s("span",{staticClass:"all search-icon",on:{click:function(t){return e.listeners.del()}}},[e._v("删除全部")]),s("span",{staticClass:"iconfont icon-shanchu search-icon"})]),s("ul",{staticClass:"search-list"},e._l(e.props.list,(function(t,a){return s("li",{key:a,staticClass:"search-item",on:{click:function(s){return e.listeners.handleSearch(t)}}},[e._v(" "+e._s(t)+" ")])})),0)])},p=[],d={name:"SearchList",props:{list:{type:Array,default:function(){return[]}},visible:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hotTitle:{type:String,default:""}}},v=d,g=(s("b16c"),s("2877")),m=Object(g["a"])(v,f,p,!0,null,"780e4775",null),y=m.exports,b=function(t,e){var s=e._c;return s("div",{staticClass:"result"},[s("ul",{staticClass:"result-list"},e._l(e.props.list,(function(t,a){return s("li",{key:a,staticClass:"result-item",on:{click:function(s){return e.listeners.play(t,a)}}},[e._t("default",null,{item:t})],2)})),0),e.props.noResult?s("p",{staticStyle:{color:"red",textAlign:"center",marginTop:"0.4rem"}},[e._v("暂无结果")]):e._e()])},x=[],L={name:"Result"},S=L,O=(s("a0a1"),Object(g["a"])(S,b,x,!0,null,"eca0d6e6",null)),k=O.exports,_={name:"Search",components:{SearchList:y,SearchResult:k},data:function(){return{searchData:"",hotLsit:[],searchList:[],flag:null,noResult:!1}},computed:Object(i["a"])({highlight:function(){var t=new RegExp(this.searchData,"gi");return function(e){return e.replace(t,"<span class='red'>".concat(this.searchData,"</span>"))}}},Object(c["c"])(["playList","historyList"])),watch:{searchData:function(t){var e=this;this.debounce((function(){e.getSearch(t)}),300)}},created:function(){this.getHotList()},methods:Object(i["a"])({debounce:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.flag&&clearTimeout(this.flag),this.flag=setTimeout(t,e)},getSearch:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a,r,n,i,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.searchData){s.next=3;break}return e.searchList=[],s.abrupt("return");case 3:return s.next=5,l(t);case 5:if(a=s.sent,r=a.code,n=a.result,200!==r){s.next=17;break}if(i=n.songs,i){s.next=14;break}return e.searchList=[],e.noResult=!0,s.abrupt("return");case 14:e.noResult=!1,c=i.reduce((function(t,e){var s={id:e.id,name:e.name,singer:e.artists[0].name,picUrl:e.artists[0].img1v1Url};return t.push(s),t}),[]),e.searchList=Object.freeze(c);case 17:case"end":return s.stop()}}),s)})))()},getHotList:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:s=e.sent,a=s.code,r=s.result,200===a&&(n=r.hots,i=n.reduce((function(t,e){return t.push(e.first),t}),[]),t.hotLsit=i);case 6:case"end":return e.stop()}}),e)})))()},cancle:function(){this.searchData="",this.searchList=[]},del:function(){var t=this;0!==this.historyList.length&&this.$MessageBox({title:"",content:"是否要删除全部"}).then((function(){t.setHistoryList([]),localStorage.setItem("history",JSON.stringify([]))})).catch((function(){}))},play:function(t){var e=this.historyList,s=e.indexOf(this.searchData);s>-1&&e.splice(s,1),e.length>=10&&e.pop(),e.unshift(this.searchData);var a=Object(h["a"])(this.playList,t),r=a.findIndex((function(e){return e.id===t.id}));localStorage.setItem("history",JSON.stringify(e)),this.setPlay(a),this.setCurrrentIndex(r),this.setFullScreen(!0),this.setHistoryList(e)}},Object(c["d"])(["setCurrrentIndex","setPlay","setFullScreen","setHistoryList"]))},w=_,C=(s("0f70"),Object(g["a"])(w,a,r,!1,null,"e29fbc52",null));e["default"]=C.exports}}]);
//# sourceMappingURL=search.01d89657.js.map